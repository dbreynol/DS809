<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Set 4 ARIMA | DS809</title>
  <meta name="description" content="Course materials for DS809, Spring 2024." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Set 4 ARIMA | DS809" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for DS809, Spring 2024." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Set 4 ARIMA | DS809" />
  
  <meta name="twitter:description" content="Course materials for DS809, Spring 2024." />
  

<meta name="author" content="David Reynolds" />


<meta name="date" content="2025-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arma.html"/>
<link rel="next" href="review-mild-extensions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UNH DS809</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course Info</a></li>
<li class="chapter" data-level="2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html"><i class="fa fa-check"></i><b>2</b> Exploratory Analysis of Time Series Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#time-series-data"><i class="fa fa-check"></i><b>2.1</b> Time Series Data</a></li>
<li class="chapter" data-level="2.2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#time-series-eda"><i class="fa fa-check"></i><b>2.2</b> Time Series EDA</a></li>
<li class="chapter" data-level="2.3" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#classical-regression"><i class="fa fa-check"></i><b>2.3</b> Classical Regression</a></li>
<li class="chapter" data-level="2.4" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#noise-processes"><i class="fa fa-check"></i><b>2.4</b> Noise Processes</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#white-noise"><i class="fa fa-check"></i><b>2.4.1</b> White noise</a></li>
<li class="chapter" data-level="2.4.2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#random-walk"><i class="fa fa-check"></i><b>2.4.2</b> Random Walk</a></li>
<li class="chapter" data-level="2.4.3" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#ar-process"><i class="fa fa-check"></i><b>2.4.3</b> AR Process</a></li>
<li class="chapter" data-level="2.4.4" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#exercise"><i class="fa fa-check"></i><b>2.4.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#measures-of-dependence"><i class="fa fa-check"></i><b>2.5</b> Measures of Dependence</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#autocovariance"><i class="fa fa-check"></i><b>2.5.1</b> Autocovariance</a></li>
<li class="chapter" data-level="2.5.2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#autocorrelation"><i class="fa fa-check"></i><b>2.5.2</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.5.3" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#exercise-1"><i class="fa fa-check"></i><b>2.5.3</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#stationarity"><i class="fa fa-check"></i><b>2.6</b> Stationarity</a></li>
<li class="chapter" data-level="2.7" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#estimation"><i class="fa fa-check"></i><b>2.7</b> Estimation</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#mean"><i class="fa fa-check"></i><b>2.7.1</b> Mean</a></li>
<li class="chapter" data-level="2.7.2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#autocovariance-1"><i class="fa fa-check"></i><b>2.7.2</b> Autocovariance</a></li>
<li class="chapter" data-level="2.7.3" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#autocorrelation-1"><i class="fa fa-check"></i><b>2.7.3</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#lab-1"><i class="fa fa-check"></i><b>2.8</b> Lab 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="arma.html"><a href="arma.html"><i class="fa fa-check"></i><b>3</b> ARMA</a>
<ul>
<li class="chapter" data-level="3.1" data-path="arma.html"><a href="arma.html#operators"><i class="fa fa-check"></i><b>3.1</b> Operators</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="arma.html"><a href="arma.html#backshift-operator"><i class="fa fa-check"></i><b>3.1.1</b> Backshift operator</a></li>
<li class="chapter" data-level="3.1.2" data-path="arma.html"><a href="arma.html#the-difference-operator"><i class="fa fa-check"></i><b>3.1.2</b> The difference operator</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="arma.html"><a href="arma.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>3.2</b> Autoregressive (AR) models</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="arma.html"><a href="arma.html#ar1-model"><i class="fa fa-check"></i><b>3.2.1</b> AR(1) Model</a></li>
<li class="chapter" data-level="3.2.2" data-path="arma.html"><a href="arma.html#ar-stationarity"><i class="fa fa-check"></i><b>3.2.2</b> AR Stationarity</a></li>
<li class="chapter" data-level="3.2.3" data-path="arma.html"><a href="arma.html#autocorrelation-2"><i class="fa fa-check"></i><b>3.2.3</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="arma.html"><a href="arma.html#moving-average-ma-models"><i class="fa fa-check"></i><b>3.3</b> Moving Average (MA) models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="arma.html"><a href="arma.html#examples-of-maq-models"><i class="fa fa-check"></i><b>3.3.1</b> Examples of MA(<em>q</em>) models</a></li>
<li class="chapter" data-level="3.3.2" data-path="arma.html"><a href="arma.html#ma1-model"><i class="fa fa-check"></i><b>3.3.2</b> MA(1) Model</a></li>
<li class="chapter" data-level="3.3.3" data-path="arma.html"><a href="arma.html#invertibility"><i class="fa fa-check"></i><b>3.3.3</b> Invertibility</a></li>
<li class="chapter" data-level="3.3.4" data-path="arma.html"><a href="arma.html#autocorrelation-3"><i class="fa fa-check"></i><b>3.3.4</b> Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="arma.html"><a href="arma.html#pacf"><i class="fa fa-check"></i><b>3.4</b> PACF</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="arma.html"><a href="arma.html#definition"><i class="fa fa-check"></i><b>3.4.1</b> Definition</a></li>
<li class="chapter" data-level="3.4.2" data-path="arma.html"><a href="arma.html#ar1-pacf"><i class="fa fa-check"></i><b>3.4.2</b> AR(1) PACF</a></li>
<li class="chapter" data-level="3.4.3" data-path="arma.html"><a href="arma.html#pacf-for-arp"><i class="fa fa-check"></i><b>3.4.3</b> PACF for AR(p)</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="arma.html"><a href="arma.html#ar-estimation"><i class="fa fa-check"></i><b>3.5</b> AR Estimation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="arma.html"><a href="arma.html#yule-walker-equations"><i class="fa fa-check"></i><b>3.5.1</b> Yule-Walker Equations</a></li>
<li class="chapter" data-level="3.5.2" data-path="arma.html"><a href="arma.html#example"><i class="fa fa-check"></i><b>3.5.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="arma.html"><a href="arma.html#arma-models"><i class="fa fa-check"></i><b>3.6</b> ARMA models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="arma.html"><a href="arma.html#psi-representation"><i class="fa fa-check"></i><b>3.6.1</b> <span class="math inline">\(\psi\)</span> representation</a></li>
<li class="chapter" data-level="3.6.2" data-path="arma.html"><a href="arma.html#arma11"><i class="fa fa-check"></i><b>3.6.2</b> ARMA(1,1)</a></li>
<li class="chapter" data-level="3.6.3" data-path="arma.html"><a href="arma.html#forecasting"><i class="fa fa-check"></i><b>3.6.3</b> Forecasting</a></li>
<li class="chapter" data-level="3.6.4" data-path="arma.html"><a href="arma.html#forecast-errors"><i class="fa fa-check"></i><b>3.6.4</b> Forecast Errors</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="arma.html"><a href="arma.html#lab-2"><i class="fa fa-check"></i><b>3.7</b> Lab 2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arima.html"><a href="arima.html"><i class="fa fa-check"></i><b>4</b> ARIMA</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arima.html"><a href="arima.html#stationarity-1"><i class="fa fa-check"></i><b>4.1</b> Stationarity</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="arima.html"><a href="arima.html#visual-test"><i class="fa fa-check"></i><b>4.1.1</b> Visual Test</a></li>
<li class="chapter" data-level="4.1.2" data-path="arima.html"><a href="arima.html#unit-root-tests"><i class="fa fa-check"></i><b>4.1.2</b> Unit Root Tests</a></li>
<li class="chapter" data-level="4.1.3" data-path="arima.html"><a href="arima.html#dickey-fuller-test-df"><i class="fa fa-check"></i><b>4.1.3</b> Dickey Fuller Test (DF)</a></li>
<li class="chapter" data-level="4.1.4" data-path="arima.html"><a href="arima.html#augmented-df-test"><i class="fa fa-check"></i><b>4.1.4</b> Augmented DF Test</a></li>
<li class="chapter" data-level="4.1.5" data-path="arima.html"><a href="arima.html#adf-tseriesadf.test"><i class="fa fa-check"></i><b>4.1.5</b> ADF: <code>tseries::adf.test()</code></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="arima.html"><a href="arima.html#differencing-nabla"><i class="fa fa-check"></i><b>4.2</b> Differencing <span class="math inline">\(\nabla\)</span></a></li>
<li class="chapter" data-level="4.3" data-path="arima.html"><a href="arima.html#arima-models"><i class="fa fa-check"></i><b>4.3</b> ARIMA Models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="arima.html"><a href="arima.html#arima111"><i class="fa fa-check"></i><b>4.3.1</b> ARIMA(1,1,1)</a></li>
<li class="chapter" data-level="4.3.2" data-path="arima.html"><a href="arima.html#real-data-example"><i class="fa fa-check"></i><b>4.3.2</b> Real Data Example</a></li>
<li class="chapter" data-level="4.3.3" data-path="arima.html"><a href="arima.html#model-selection-fitting"><i class="fa fa-check"></i><b>4.3.3</b> Model Selection/ Fitting</a></li>
<li class="chapter" data-level="4.3.4" data-path="arima.html"><a href="arima.html#model-selection---automated"><i class="fa fa-check"></i><b>4.3.4</b> Model Selection - automated</a></li>
<li class="chapter" data-level="4.3.5" data-path="arima.html"><a href="arima.html#model-checking"><i class="fa fa-check"></i><b>4.3.5</b> Model Checking</a></li>
<li class="chapter" data-level="4.3.6" data-path="arima.html"><a href="arima.html#forecasting-1"><i class="fa fa-check"></i><b>4.3.6</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="arima.html"><a href="arima.html#sarima"><i class="fa fa-check"></i><b>4.4</b> SARIMA</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="arima.html"><a href="arima.html#unpacking-notation"><i class="fa fa-check"></i><b>4.4.1</b> Unpacking Notation</a></li>
<li class="chapter" data-level="4.4.2" data-path="arima.html"><a href="arima.html#data-example"><i class="fa fa-check"></i><b>4.4.2</b> Data Example</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="arima.html"><a href="arima.html#lab-3"><i class="fa fa-check"></i><b>4.5</b> Lab 3</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="review-mild-extensions.html"><a href="review-mild-extensions.html"><i class="fa fa-check"></i><b>5</b> Review/ Mild Extensions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="review-mild-extensions.html"><a href="review-mild-extensions.html#linear-filtering"><i class="fa fa-check"></i><b>5.1</b> <em>Linear Filtering</em></a></li>
<li class="chapter" data-level="5.2" data-path="review-mild-extensions.html"><a href="review-mild-extensions.html#ar-parameter-constraints"><i class="fa fa-check"></i><b>5.2</b> <em>AR Parameter Constraints</em></a></li>
<li class="chapter" data-level="5.3" data-path="review-mild-extensions.html"><a href="review-mild-extensions.html#ma-parameter-constraints"><i class="fa fa-check"></i><b>5.3</b> <em>MA Parameter Constraints</em></a></li>
<li class="chapter" data-level="5.4" data-path="review-mild-extensions.html"><a href="review-mild-extensions.html#sarima-models"><i class="fa fa-check"></i><b>5.4</b> <em>SARIMA models</em></a></li>
<li class="chapter" data-level="5.5" data-path="review-mild-extensions.html"><a href="review-mild-extensions.html#residuals-check"><i class="fa fa-check"></i><b>5.5</b> <em>Residuals check</em></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="volatility-models.html"><a href="volatility-models.html"><i class="fa fa-check"></i><b>6</b> Volatility Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="volatility-models.html"><a href="volatility-models.html#arch1"><i class="fa fa-check"></i><b>6.1</b> ARCH(1)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="volatility-models.html"><a href="volatility-models.html#statistical-properties"><i class="fa fa-check"></i><b>6.1.1</b> Statistical Properties</a></li>
<li class="chapter" data-level="6.1.2" data-path="volatility-models.html"><a href="volatility-models.html#simulation-model-fit"><i class="fa fa-check"></i><b>6.1.2</b> Simulation/ Model Fit</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="volatility-models.html"><a href="volatility-models.html#garch11"><i class="fa fa-check"></i><b>6.2</b> GARCH(1,1)</a></li>
<li class="chapter" data-level="6.3" data-path="volatility-models.html"><a href="volatility-models.html#fgarchgarchfit"><i class="fa fa-check"></i><b>6.3</b> <code>fGarch::garchFit</code></a></li>
<li class="chapter" data-level="6.4" data-path="volatility-models.html"><a href="volatility-models.html#lab-5"><i class="fa fa-check"></i><b>6.4</b> Lab 5</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DS809</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="arima" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Set 4</span> ARIMA<a href="arima.html#arima" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="stationarity-1" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Stationarity<a href="arima.html#stationarity-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The ARMA model we have seen assumes stationary data. Stationarity means ‘not changing in time’ in the context of time-series models. In a typical data analysis, however, we will not be assured that our data is stationary. Therefore, we need some methods to evaluate stationarity and also to deal with nonstationary data.</p>
<p>We will discuss 2 common approaches to evaluating stationarity:</p>
<ol style="list-style-type: decimal">
<li>Visual test</li>
<li>Unit Root Test (ADF)</li>
</ol>
<div id="visual-test" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Visual Test<a href="arima.html#visual-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The visual test is simply looking at a plot of the data versus time. Look for:</p>
<ul>
<li>Change in the level over time. Is the time series increasing or decreasing? Does it appear to cycle?</li>
<li>Change in the variance over time. Do deviations away from the mean change over time, increase or decrease?</li>
</ul>
</div>
<div id="unit-root-tests" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Unit Root Tests<a href="arima.html#unit-root-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the most common forms of non-stationarity that is tested for is that the process has a random walk component, such as <span class="math inline">\(x_t = x_{t-1} + e_t\)</span>. A random walk is called a ‘unit root’ process in the time series literature since it occurs when one of the roots of the AR polynomial is 1. A test for an underlying random walk is called a ‘unit root’ test.</p>
</div>
<div id="dickey-fuller-test-df" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Dickey Fuller Test (DF)<a href="arima.html#dickey-fuller-test-df" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The DF tests for a unit root in the context of an AR(1) model, which can be written,</p>
<p><span class="math display">\[\begin{align}
x_t &amp;= \phi_1 x_{t-1} + w_t \\
\nabla x_t &amp;= (\phi_1 - 1) x_{t-1} + w_t \\
&amp;= \delta x_{t-1} + w_t
\end{align}\]</span></p>
<p>This model can be estimated, and testing for a unit root is equivalent to testing:</p>
<p><span class="math display">\[\begin{align}
H_0&amp;: \delta = 0 \\
H_A&amp;: \delta \neq 0
\end{align}\]</span></p>
<p>The test statistic has a specific distribution simply known as the Dickey–Fuller table, which is used to find the p-value. We want to reject the null hypothesis (small p-value) of non-stationarity.</p>
</div>
<div id="augmented-df-test" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Augmented DF Test<a href="arima.html#augmented-df-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Augmented Dickey-Fuller Test (ADF) looks for evidence that an AR(p) process has a unit root (an underlying random walk process).</p>
<p>The <strong>null hypothesis</strong> is that the time series has a unit root, that is, it has a random walk component.</p>
<p>The <strong>alternative hypothesis</strong> is some variation of stationarity.</p>
<p>The first difference, <span class="math inline">\(\nabla\)</span>, of the general AR(p) model can be re-written as,</p>
<p><span class="math display">\[\begin{align}
\nabla x_t = \phi_1^\prime x_{t-1} + \sum_{i=1}^{p-1} \phi_{i+1}^\prime \nabla x_{t-1} + w_t,
\end{align}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{align}
\phi_1^\prime &amp;= \sum_{j=1}^{p} \phi_{j}-1 \\
\phi_j^\prime &amp;= \sum_{j=1}^{p} \phi_{j}~\text{ for} j \geq 2
\end{align}\]</span></p>
<p>Our interest is on <span class="math inline">\(\phi_1^\prime\)</span> since it is equal to 0 exactly when 1 is a root of the AR(p) polynomial. Therefore, the hypothesis test is,</p>
<p><span class="math display">\[\begin{align}
H_0&amp;: \phi_1^\prime = 0 \\
H_A&amp;: \phi_1^\prime \neq 0
\end{align}\]</span></p>
</div>
<div id="adf-tseriesadf.test" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> ADF: <code>tseries::adf.test()</code><a href="arima.html#adf-tseriesadf.test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>adf.test()</code> in the tseries package will apply the Augmented Dickey-Fuller <strong>with a constant and trend</strong> and report the p-value. We want to reject the Dickey=Fuller null hypothesis of non-stationarity. When <code>k=0</code>, the Dickey-Fuller test asseses AR(1) stationarity. The Augmented Dickey-Fuller tests for more general lag-p stationarity.</p>
<pre><code>adf.test(x, alternative = c(&quot;stationary&quot;, &quot;explosive&quot;),
         k = trunc((length(x)-1)^(1/3)))</code></pre>
<p>In this lecture we will use differencing, the I in ARIMA model refers to differencing.</p>
</div>
</div>
<div id="differencing-nabla" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Differencing <span class="math inline">\(\nabla\)</span><a href="arima.html#differencing-nabla" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Differencing means to create a new time series <span class="math inline">\(z_t = x_t - x_{t-1}\)</span>. The I in ARIMA model refers to differencing. First order differencing means you do this once (so <span class="math inline">\(z_t\)</span>) and second order differencing means you do this twice (so <span class="math inline">\(z_t - z_{t-1}\)</span>).</p>
<p>The <code>diff()</code> function takes the first difference:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="arima.html#cb27-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">11</span>))</span>
<span id="cb27-2"><a href="arima.html#cb27-2" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>The second difference is the first difference of the first difference.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="arima.html#cb29-1" tabindex="-1"></a><span class="fu">diff</span>(x)</span></code></pre></div>
<pre><code>## [1] 1 1 1</code></pre>
</div>
<div id="arima-models" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> ARIMA Models<a href="arima.html#arima-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Our data is not always stationary. If the data do not appear stationary, differencing can help. This leads to the class of <em>autoregressive integrated moving average</em> (ARIMA) models. ARIMA models are indexed with orders (<em>p</em>,<em>d</em>,<em>q</em>) where <em>d</em> indicates the order of differencing.</p>
<p><span class="math inline">\(\{x_t\}\)</span> follows an ARIMA(<em>p</em>,<em>d</em>,<em>q</em>) process if <span class="math inline">\((1-\mathbf{B})^d x_t\)</span> is an ARMA(<em>p</em>,<em>q</em>) process. In this context, <span class="math inline">\(p\)</span> refers to the order of the autoregressive part of the model, <span class="math inline">\(d\)</span> refers to the degree of differencing required, and <span class="math inline">\(q\)</span> refers to the order of the moving average component.</p>
<div id="arima111" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> ARIMA(1,1,1)<a href="arima.html#arima111" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For example, consider an ARIMA(1,1,1).</p>
<ul>
<li>What is the response variable of the model?</li>
<li>Write out the model equation.</li>
<li>What would you expect the ACF and PACF plots to look like?</li>
</ul>
</div>
<div id="real-data-example" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Real Data Example<a href="arima.html#real-data-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us look at some real data - exports of the Central African Republic from 1960-2016. In this time series, we see a clear evolution in the mean of the time series, indicating that the time series is not stationary.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="arima.html#cb31-1" tabindex="-1"></a>caf <span class="ot">=</span> tsibbledata<span class="sc">::</span>global_economy <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="arima.html#cb31-2" tabindex="-1"></a>  <span class="fu">filter</span>(Code <span class="sc">==</span> <span class="st">&quot;CAF&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="arima.html#cb31-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">first_diff =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(Exports)))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-32-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>To address the non-stationarity, we will take a first difference of the data. The differenced data are shown below.</p>
<p><img src="series_files/figure-html/unnamed-chunk-33-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The DF test corresponds with a visual assessment - the first difference appears to be stationary.</p>
</div>
<div id="model-selection-fitting" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Model Selection/ Fitting<a href="arima.html#model-selection-fitting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To assess what kind of model to fit to the data, we can look at the ACF and PACF plots of the differenced data and diagnose some candidate models. For example:</p>
<p><img src="series_files/figure-html/unnamed-chunk-34-1.png" width="672" />
The PACF above is suggestive of an AR(2) model; so an initial candidate model is an ARIMA(2,1,0). The ACF suggests an MA(3) model; so an alternative candidate is an ARIMA(0,1,3). We can fit both of these models and find which one has a better AIC score.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="arima.html#cb32-1" tabindex="-1"></a><span class="fu">Arima</span>(caf<span class="sc">$</span>Exports, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>)) <span class="co"># -134.27 / 274.54</span></span>
<span id="cb32-2"><a href="arima.html#cb32-2" tabindex="-1"></a><span class="fu">Arima</span>(caf<span class="sc">$</span>Exports, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co"># - 133.12 / 274.25</span></span></code></pre></div>
<p>Since the AIC is smaller for the ARIMA(0,1,3) model, this is a good candidate. We could also search a larger space of models with the help of the <code>auto.arima</code> function.</p>
</div>
<div id="model-selection---automated" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Model Selection - automated<a href="arima.html#model-selection---automated" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The general sequence of steps involved in fitting an ARIMA model to a given time series are:</p>
<ol style="list-style-type: decimal">
<li>Evaluate whether the time series is stationary</li>
<li>If not, make it stationary - select the differencing level (d)</li>
<li>Select the AR level (p) and the MA level (q) that optimize the AIC</li>
</ol>
<p>Steps two and three are automated with the function <code>forecast::auto.arima</code> function. For instance,</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="arima.html#cb33-1" tabindex="-1"></a>m_auto <span class="ot">=</span> <span class="fu">auto.arima</span>(caf<span class="sc">$</span>Exports)</span></code></pre></div>
<p>The model selected by this stepwise procedure is an ARIMA(2,1,2), whose AIC is 274.2, a small improvement over the AIC value of the ARIMA(0,1,3), which was selected by visual inspection of the ACF/ PACF plots.</p>
</div>
<div id="model-checking" class="section level3 hasAnchor" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Model Checking<a href="arima.html#model-checking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="check-the-residuals" class="section level4 hasAnchor" number="4.3.5.1">
<h4><span class="header-section-number">4.3.5.1</span> Check the residuals<a href="arima.html#check-the-residuals" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Residuals = difference between the observations (data), <span class="math inline">\(y\)</span>, and expected (fitted) values, <span class="math inline">\(\hat{y}\)</span>. Thus, the i’th residual is: <span class="math inline">\(y_i-\hat{y}_i\)</span>.</p>
<p>In R, we can obtain the vector of residuals using the <code>residuals</code> function.</p>
<p><img src="series_files/figure-html/unnamed-chunk-37-1.png" width="672" />
What do we aim to see in these plots? Do we?</p>
<p>We could alternatively use a hypothesis test (Box-Pierce test) in which:</p>
<p><span class="math display">\[\begin{align}
H_0 &amp;: \rho_1 = \rho_2 = \ldots = \rho_k = 0 \\
H_A &amp;: \text{at least one autocorrelation is different from 0}
\end{align}\]</span></p>
<p>The test statistic (the Ljung-Box Q-Statistic) for this test:</p>
<p><span class="math display">\[\begin{align}
Q = n(n+2) \sum_{i=1}^k \frac{\hat{\rho}_i^2}{(n-k)}
\end{align}\]</span></p>
<p>follows a chi-squared distribution with <span class="math inline">\(k\)</span> degrees of freedom under the null hypothesis.</p>
</div>
</div>
<div id="forecasting-1" class="section level3 hasAnchor" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Forecasting<a href="arima.html#forecasting-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="point-estimates" class="section level4 hasAnchor" number="4.3.6.1">
<h4><span class="header-section-number">4.3.6.1</span> Point Estimates<a href="arima.html#point-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The basic idea of forecasting with an ARIMA model is to estimate the parameters and forecast forward.</p>
<p>For example, let’s say we want to forecast Central African Exports with the ARIMA(2,1,0) model with drift:
<span class="math display">\[z_t = \mu + \phi_1 z_{t-1} + \phi_2 z_{t-2} + w_t\]</span>
where <span class="math inline">\(z_t = x_t - x_{t-1}\)</span>, the first difference.</p>
<p><code>Arima()</code> would write this model:</p>
<p><span class="math display">\[(z_t-m) = \phi_1 (z_{t-1}-m) + \phi_2 (z_{t-2}-m) + e_t\]</span>
The relationship between <span class="math inline">\(\mu\)</span> and <span class="math inline">\(m\)</span> is <span class="math inline">\(\mu = m(1 - \phi_1 - \phi_2)\)</span>.</p>
<p>Let’s estimate the <span class="math inline">\(\phi\)</span>’s for this model from the Central African export data.</p>
<pre><code>##        ar1        ar2      drift 
## -0.5230284 -0.3065268 -0.2119722</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="arima.html#cb35-1" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="dv">3</span>]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">coef</span>(fit)[<span class="dv">1</span>]<span class="sc">-</span><span class="fu">coef</span>(fit)[<span class="dv">2</span>])</span></code></pre></div>
<p>So, <span class="math inline">\(\mu=\)</span> -0.39</p>
<p>So we can forecast with this model:</p>
<p><span class="math inline">\(z_t =\)</span> -0.39 + -0.52 <span class="math inline">\(z_{t-1}\)</span> -0.31<span class="math inline">\(z_{t-2}\)</span> + <span class="math inline">\(w_t\)</span>
To obtain the <span class="math inline">\(T+1\)</span> forecast value:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="arima.html#cb36-1" tabindex="-1"></a>zt_1 <span class="ot">=</span> <span class="fl">12.51809</span> <span class="sc">-</span> <span class="fl">12.72904</span></span>
<span id="cb36-2"><a href="arima.html#cb36-2" tabindex="-1"></a>zt_2 <span class="ot">=</span> <span class="fl">12.72904</span> <span class="sc">-</span> <span class="fl">12.61192</span></span>
<span id="cb36-3"><a href="arima.html#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="arima.html#cb36-4" tabindex="-1"></a><span class="fl">12.51809</span> <span class="sc">+</span> (<span class="sc">-</span><span class="fl">0.3878149</span> <span class="sc">-</span><span class="fl">0.5230284</span> <span class="sc">*</span> zt_1 <span class="sc">-</span> <span class="fl">0.3065268</span> <span class="sc">*</span> zt_2)</span></code></pre></div>
<pre><code>## [1] 12.20471</code></pre>
<p>You can also use the <code>forecast</code> function to obtain point estimates and prediction intervals. For example,</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="arima.html#cb38-1" tabindex="-1"></a>fr <span class="ot">=</span> <span class="fu">forecast</span>(fit, <span class="at">h =</span> <span class="dv">5</span>)</span>
<span id="cb38-2"><a href="arima.html#cb38-2" tabindex="-1"></a><span class="fu">plot</span>(fr) </span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="sarima" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> SARIMA<a href="arima.html#sarima" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have restricted our attention to non-seasonal data and non-seasonal ARIMA models. However, ARIMA models are also capable of modelling a wide range of seasonal data. A seasonal ARIMA model is formed by including additional seasonal terms in the ARIMA models we have seen so far. It is written as follows:</p>
<p><span class="math display">\[ARIMA(p,d,q)~(P,D,Q)_m\]</span>
where <span class="math inline">\(m\)</span> is the seasonal period (e.g., number of observations per seasonal period). We use uppercase notation for the seasonal parts of the model, and lowercase notation for the non-seasonal parts of the model.</p>
<p>The seasonal part of the model consists of terms that are similar to the non-seasonal components of the model, but involve backshifts of the seasonal period. The modelling procedure is almost the same as for non-seasonal data, except that we need to select seasonal AR and MA terms as well as the non-seasonal components of the model. Let us start by unpacking some simple SARIMA models.</p>
<div id="unpacking-notation" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Unpacking Notation<a href="arima.html#unpacking-notation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Consider the SARIMA model, ARIMA<span class="math inline">\((0,0,0)(0,0,1)_{12}\)</span></p>
<ul>
<li><p>Write out the model equation</p></li>
<li><p>What is the theoretical variance of the model?</p></li>
<li><p>What is the theoretical autocorrelation function?</p></li>
<li><p>What would you expect to see in the seasonal lags of the PACF?</p></li>
</ul>
<p>Consider the SARIMA model, ARIMA<span class="math inline">\((0,0,0)(1,0,0)_{12}\)</span></p>
<ul>
<li><p>Write out the model equation</p></li>
<li><p>What is the theoretical variance of the model?</p></li>
<li><p>What is the theoretical autocorrelation function?</p></li>
<li><p>What would you expect to see in the seasonal lags of the PACF?</p></li>
</ul>
</div>
<div id="data-example" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Data Example<a href="arima.html#data-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To see how this looks with real data, we will try to forecast monthly corticosteroid drug sales in Australia. These are known as H02 drugs under the Anatomical Therapeutic Chemical classification scheme. Their primary application is the treatment of allergic reactions, and are therefore highly seasonal. The dataset is <code>tsibbledata::PBS</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="arima.html#cb39-1" tabindex="-1"></a>h02 <span class="ot">&lt;-</span> PBS  <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="arima.html#cb39-2" tabindex="-1"></a>  <span class="fu">filter</span>(ATC2 <span class="sc">==</span> <span class="st">&quot;H02&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="arima.html#cb39-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Cost =</span> <span class="fu">sum</span>(Cost)<span class="sc">/</span><span class="fl">1e6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="arima.html#cb39-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lcost =</span> <span class="fu">log</span>(Cost)) <span class="sc">%&gt;%</span> </span>
<span id="cb39-5"><a href="arima.html#cb39-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dlcost =</span> <span class="fu">c</span>( <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="fu">diff</span>(lcost, <span class="dv">12</span>)))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-44-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The data are strongly seasonal and obviously non-stationary, so seasonal differencing will be used. The seasonally differenced data are shown below. The differenced data appear somewhat stationary and the null hypothesis is rejected in the ADF test, so our response variable will be: <span class="math inline">\(z_t = x_t - x_{t-12}\)</span>.</p>
<p><img src="series_files/figure-html/unnamed-chunk-45-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Below we examine the ACF and PACF of <span class="math inline">\(z_t\)</span>.</p>
<p><img src="series_files/figure-html/unnamed-chunk-46-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In the plots of the seasonally differenced data, there are spikes in the PACF at lags 12 and 24, but nothing at seasonal lags in the ACF. This may be suggestive of a seasonal AR(2) term. In the non-seasonal lags, there are three significant spikes in the PACF, suggesting a possible AR(3) term. The pattern in the ACF is not indicative of any simple model. This initial analysis suggests that a possible model for these data is an ARIMA<span class="math inline">\((3,0,0)(2,1,0)_{12}\)</span>. We fit this model below:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="arima.html#cb40-1" tabindex="-1"></a>Cost <span class="ot">=</span> <span class="fu">ts</span>(h02<span class="sc">$</span>Cost, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1991</span>, <span class="dv">7</span>)) </span>
<span id="cb40-2"><a href="arima.html#cb40-2" tabindex="-1"></a>m0 <span class="ot">=</span> <span class="fu">arima</span>(Cost, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">seasonal =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb40-3"><a href="arima.html#cb40-3" tabindex="-1"></a>m0 <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ar1</td>
<td align="right">0.0985710</td>
<td align="right">0.0701709</td>
</tr>
<tr class="even">
<td align="left">ar2</td>
<td align="right">0.3980094</td>
<td align="right">0.0622226</td>
</tr>
<tr class="odd">
<td align="left">ar3</td>
<td align="right">0.3897839</td>
<td align="right">0.0724192</td>
</tr>
<tr class="even">
<td align="left">sar1</td>
<td align="right">-0.4378022</td>
<td align="right">0.0787779</td>
</tr>
<tr class="odd">
<td align="left">sar2</td>
<td align="right">-0.3047419</td>
<td align="right">0.0782169</td>
</tr>
</tbody>
</table>
<p>Let’s quickly examine the residuals from the model,</p>
<p><img src="series_files/figure-html/unnamed-chunk-48-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>And then we can produce forecasts for the next 12 months.</p>
<p><img src="series_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
</div>
</div>
<div id="lab-3" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Lab 3<a href="arima.html#lab-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Consider <code>fpp3::aus_airpassengers</code>, the total number of passengers (in millions) from Australian air carriers for the period 1970-2011.</li>
</ol>
<ul>
<li>Plot the data. Are the data stationary? If not, find an appropriate transformation which yields stationary data.</li>
<li>Plot the ACF and PACF of the transformed time series. What are one or two candidate models based on these plots?</li>
<li>Use <code>forecast::auto.arima()</code> to find an optimized ARIMA model. Use the original (i.e., nonstationary) time series as the input. What model was selected? Write the fit model equation.</li>
<li>Check that the residuals look like white noise. <code>forecast::checkresiduals</code></li>
<li>Plot forecasts for the next 10 periods. <code>forecast::forecast</code></li>
<li>Plot forecasts from an ARIMA(0,1,0) model with drift and compare these to the automatically selected model.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Choose an employment type from <code>fpp3::us_employment</code>, the total employment in different industries in the United States.</li>
</ol>
<ul>
<li>Are the data stationary? If not, find an appropriate transformation which yields stationary data.</li>
<li>Examine ACF and PACF plots of the transformed data (if this was necessary to attain stationarity) to identify a couple of ARIMA models that might be useful in describing the time series. Which of your models is the best according to their AIC values?</li>
<li>Estimate the parameters of your best model and do diagnostic testing on the residuals. Do the residuals resemble white noise? If not, try to find another ARIMA model which fits better.</li>
<li>Forecast the next 3 years of data. Get the latest figures from <a href="https://fred.stlouisfed.org/categories/11" class="uri">https://fred.stlouisfed.org/categories/11</a> to check the accuracy of your forecasts.</li>
<li>Eventually, the prediction intervals are so wide that the forecasts are not particularly useful. How many years of forecasts do you think are sufficiently accurate to be usable?</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arma.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="review-mild-extensions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dbreynol/DS809/edit/master/set3_25.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
