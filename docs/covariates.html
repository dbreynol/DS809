<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Set 6 Covariates | DS809</title>
  <meta name="description" content="Course materials for DS809, Spring 2024." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Set 6 Covariates | DS809" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Course materials for DS809, Spring 2024." />
  <meta name="github-repo" content="openscapes/series" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Set 6 Covariates | DS809" />
  
  <meta name="twitter:description" content="Course materials for DS809, Spring 2024." />
  

<meta name="author" content="David Reynolds" />


<meta name="date" content="2024-02-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prophet-lab.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UNH DS809</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Course Info</a></li>
<li class="chapter" data-level="2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html"><i class="fa fa-check"></i><b>2</b> Exploratory Analysis of Time Series Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#time-series-data"><i class="fa fa-check"></i><b>2.1</b> Time Series Data</a></li>
<li class="chapter" data-level="2.2" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#time-series-eda"><i class="fa fa-check"></i><b>2.2</b> Time Series EDA</a></li>
<li class="chapter" data-level="2.3" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#multiple-time-series"><i class="fa fa-check"></i><b>2.3</b> Multiple Time Series</a></li>
<li class="chapter" data-level="2.4" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#autocorrelation"><i class="fa fa-check"></i><b>2.4</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.5" data-path="exploratory-analysis-of-time-series-data.html"><a href="exploratory-analysis-of-time-series-data.html#lab-1"><i class="fa fa-check"></i><b>2.5</b> Lab 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html"><i class="fa fa-check"></i><b>3</b> Smoothing, Decomposition, Noise</a>
<ul>
<li class="chapter" data-level="3.1" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#exponential-smoothing"><i class="fa fa-check"></i><b>3.1</b> Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#optimization"><i class="fa fa-check"></i><b>3.1.1</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#decomposition"><i class="fa fa-check"></i><b>3.2</b> Decomposition</a></li>
<li class="chapter" data-level="3.3" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#statistical-models"><i class="fa fa-check"></i><b>3.3</b> Statistical Models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#random-walk"><i class="fa fa-check"></i><b>3.3.1</b> Random Walk</a></li>
<li class="chapter" data-level="3.3.2" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#white-noise"><i class="fa fa-check"></i><b>3.3.2</b> White noise</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#stationarity"><i class="fa fa-check"></i><b>3.4</b> Stationarity</a></li>
<li class="chapter" data-level="3.5" data-path="smoothing-decomposition-noise.html"><a href="smoothing-decomposition-noise.html#lab-2"><i class="fa fa-check"></i><b>3.5</b> Lab 2</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>4</b> ARIMA Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="arima-models.html"><a href="arima-models.html#ar-models"><i class="fa fa-check"></i><b>4.1</b> AR Models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="arima-models.html"><a href="arima-models.html#ar1-model"><i class="fa fa-check"></i><b>4.1.1</b> AR(1) Model</a></li>
<li class="chapter" data-level="4.1.2" data-path="arima-models.html"><a href="arima-models.html#ar-stationarity"><i class="fa fa-check"></i><b>4.1.2</b> <span style="color: red;"> AR Stationarity </span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="arima-models.html"><a href="arima-models.html#ma-models"><i class="fa fa-check"></i><b>4.2</b> MA Models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="arima-models.html"><a href="arima-models.html#ma1-model"><i class="fa fa-check"></i><b>4.2.1</b> MA(1) Model</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="arima-models.html"><a href="arima-models.html#arma-models"><i class="fa fa-check"></i><b>4.3</b> ARMA Models</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="arima-models.html"><a href="arima-models.html#acf-for-armapq-models"><i class="fa fa-check"></i><b>4.3.1</b> ACF for ARMA(<em>p</em>,<em>q</em>) models</a></li>
<li class="chapter" data-level="4.3.2" data-path="arima-models.html"><a href="arima-models.html#pacf-for-armapq-models"><i class="fa fa-check"></i><b>4.3.2</b> PACF for ARMA(<em>p</em>,<em>q</em>) models</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="arima-models.html"><a href="arima-models.html#arima-models-1"><i class="fa fa-check"></i><b>4.4</b> ARIMA Models</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="arima-models.html"><a href="arima-models.html#model-selection-fitting"><i class="fa fa-check"></i><b>4.4.1</b> Model Selection/ Fitting</a></li>
<li class="chapter" data-level="4.4.2" data-path="arima-models.html"><a href="arima-models.html#model-checking"><i class="fa fa-check"></i><b>4.4.2</b> Model Checking</a></li>
<li class="chapter" data-level="4.4.3" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>4.4.3</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="arima-models.html"><a href="arima-models.html#lab-3"><i class="fa fa-check"></i><b>4.5</b> Lab 3</a></li>
<li class="chapter" data-level="4.6" data-path="arima-models.html"><a href="arima-models.html#lab-3.5"><i class="fa fa-check"></i><b>4.6</b> Lab 3.5</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="prophet-lab.html"><a href="prophet-lab.html"><i class="fa fa-check"></i><b>5</b> Prophet Lab</a></li>
<li class="chapter" data-level="6" data-path="covariates.html"><a href="covariates.html"><i class="fa fa-check"></i><b>6</b> Covariates</a>
<ul>
<li class="chapter" data-level="6.1" data-path="covariates.html"><a href="covariates.html#linear-regression"><i class="fa fa-check"></i><b>6.1</b> Linear Regression</a></li>
<li class="chapter" data-level="6.2" data-path="covariates.html"><a href="covariates.html#dynlm-linear-model"><i class="fa fa-check"></i><b>6.2</b> <code>dynlm</code> Linear Model</a></li>
<li class="chapter" data-level="6.3" data-path="covariates.html"><a href="covariates.html#lm-with-arima-errors"><i class="fa fa-check"></i><b>6.3</b> <code>lm</code> with ARIMA Errors</a></li>
<li class="chapter" data-level="6.4" data-path="covariates.html"><a href="covariates.html#state-space-model"><i class="fa fa-check"></i><b>6.4</b> State Space Model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="covariates.html"><a href="covariates.html#framework"><i class="fa fa-check"></i><b>6.4.1</b> Framework</a></li>
<li class="chapter" data-level="6.4.2" data-path="covariates.html"><a href="covariates.html#specific-problem"><i class="fa fa-check"></i><b>6.4.2</b> Specific Problem</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DS809</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="covariates" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Set 6</span> Covariates<a href="covariates.html#covariates" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="series_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div id="linear-regression" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Linear Regression<a href="covariates.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We begin by modeling <span class="math inline">\(y=\)</span> Quotes as a <em>linear function</em> of <span class="math inline">\(x=\)</span> TV Spend. That is, we have the following model:</p>
<p><span class="math display">\[\begin{align}
y_t = \beta_0 + \beta_1 x_t + e_t,
\end{align}\]</span></p>
<p>where <span class="math inline">\(e_1, \ldots, e_t\)</span> are mutually independent and each <span class="math inline">\(e_t \sim \text{N}(0,\sigma^2)\)</span>.</p>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.2401883</td>
<td align="right">0.9008432</td>
<td align="right">-0.2666261</td>
<td align="right">0.7911986</td>
</tr>
<tr class="even">
<td align="left">TVadverts</td>
<td align="right">1.6934377</td>
<td align="right">0.1088208</td>
<td align="right">15.5617088</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<p><img src="series_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>When we do regressions using time series variables, it is common for the errors (residuals) to have a time series structure. This violates the usual assumption of independent errors made in ordinary least squares regression. The consequence is that the estimates of coefficients and their standard errors will be wrong if the time series structure of the errors is ignored.</p>
</div>
<div id="dynlm-linear-model" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> <code>dynlm</code> Linear Model<a href="covariates.html#dynlm-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another way of fitting a linear model to time series data is using the package <code>dynlm</code>. This package, through its namesake function <code>dynlm</code>, fits the same model as above but is noteworthy for its helpful set of functions related to time. Before showing those, let us fit the same model as above using <code>dynlm</code>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="covariates.html#cb48-1" tabindex="-1"></a><span class="co"># option two - time series regression: LM with very useful time functions</span></span>
<span id="cb48-2"><a href="covariates.html#cb48-2" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">ts</span>(insurance<span class="sc">$</span>Quotes, <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb48-3"><a href="covariates.html#cb48-3" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">ts</span>(insurance<span class="sc">$</span>TVadverts, <span class="at">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb48-4"><a href="covariates.html#cb48-4" tabindex="-1"></a>md <span class="ot">=</span> <span class="fu">dynlm</span>(y <span class="sc">~</span> x1 )</span>
<span id="cb48-5"><a href="covariates.html#cb48-5" tabindex="-1"></a><span class="fu">summary</span>(md) <span class="sc">%&gt;%</span> <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">-0.2401883</td>
<td align="right">0.9008432</td>
<td align="right">-0.2666261</td>
<td align="right">0.7911986</td>
</tr>
<tr class="even">
<td align="left">x1</td>
<td align="right">1.6934377</td>
<td align="right">0.1088208</td>
<td align="right">15.5617088</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<p>The results from this model are identcal to the simple linear regression. The utility of this package comes from the ease with which you can add lagged terms, trends and seasonal factors:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="covariates.html#cb49-1" tabindex="-1"></a>md2 <span class="ot">=</span> <span class="fu">dynlm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> <span class="fu">L</span>(x1,<span class="dv">1</span>) <span class="sc">+</span> <span class="fu">trend</span>(y) <span class="sc">+</span> <span class="fu">season</span>(y))</span></code></pre></div>
</div>
<div id="lm-with-arima-errors" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> <code>lm</code> with ARIMA Errors<a href="covariates.html#lm-with-arima-errors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is possible to adjust estimated regression coefficients and standard errors when the errors have an ARIMA structure. The purpose is to adjust “ordinary” regression estimates for the fact that the residuals have an ARIMA structure.</p>
<p>In this case, the model is written as,</p>
<p><span class="math display">\[\begin{align}
y_t &amp;= \beta_0 + \beta_1 x_t + \eta_t \\
\eta_t &amp;= \phi_1 \eta_{t-1} + \dots + \phi_p \eta_{t-p} + w_t + \theta_1 w_{t-1} + \dots + \theta_q w_{t-q},
\end{align}\]</span></p>
<p>where <span class="math inline">\(w_t \sim N(0, \sigma^2)\)</span> are white noise. This model can be fit within <code>auto.arima</code> or <code>Arima</code>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="covariates.html#cb50-1" tabindex="-1"></a><span class="co"># option three - time series with ARIMA errors</span></span>
<span id="cb50-2"><a href="covariates.html#cb50-2" tabindex="-1"></a>linmod2 <span class="ot">=</span> <span class="fu">auto.arima</span>(insurance<span class="sc">$</span>Quotes, <span class="at">xreg =</span> <span class="fu">as.matrix</span>(insurance<span class="sc">$</span>TVadverts))</span>
<span id="cb50-3"><a href="covariates.html#cb50-3" tabindex="-1"></a><span class="fu">summary</span>(linmod2)</span></code></pre></div>
<pre><code>## Series: insurance$Quotes 
## Regression with ARIMA(0,1,0) errors 
## 
## Coefficients:
##         xreg
##       1.3485
## s.e.  0.0666
## 
## sigma^2 = 0.3301:  log likelihood = -33.22
## AIC=70.44   AICc=70.77   BIC=73.77
## 
## Training set error measures:
##                       ME      RMSE       MAE         MPE     MAPE      MASE
## Training set -0.01299736 0.5599955 0.4354811 -0.09980506 3.271638 0.2767685
##                   ACF1
## Training set 0.1664547</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="covariates.html#cb52-1" tabindex="-1"></a><span class="fu">checkresiduals</span>(m0)</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(0,1,0)
## Q* = 5.0746, df = 10, p-value = 0.8861
## 
## Model df: 0.   Total lags used: 10</code></pre>
</div>
<div id="state-space-model" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> State Space Model<a href="covariates.html#state-space-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="framework" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Framework<a href="covariates.html#framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An alternate framework for time series modeling is the state space model. These models are based on a decomposition of the series into a number of components, each of which may be accompanied by error terms (and thus, uncertainty). The simplest model is the <em>local level model</em>. In this model,</p>
<p><span class="math display">\[\begin{align}
y_t &amp;= \mu_t + \epsilon_t \\
\mu_t &amp;= \mu_{t-1} + \tau_t.
\end{align}\]</span></p>
<p>The idea of this model is that the observations <span class="math inline">\(y\)</span> consist of noisy measurements (observation error) of an underlying random walk.</p>
<p>What is the estimate for <span class="math inline">\(\mu_t\)</span> when <span class="math inline">\(\tau_t = 0\)</span>? How about when <span class="math inline">\(\epsilon_t = 0\)</span>? How does this relate to simple exponential smoothing?</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="covariates.html#cb54-1" tabindex="-1"></a>ss1 <span class="ot">=</span> <span class="fu">StructTS</span>(y, <span class="at">type =</span> <span class="st">&quot;level&quot;</span>)</span>
<span id="cb54-2"><a href="covariates.html#cb54-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(ss1, <span class="at">h =</span> <span class="dv">5</span>))</span></code></pre></div>
<p><img src="series_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="specific-problem" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Specific Problem<a href="covariates.html#specific-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For our problem, we will introduce the covariate into the measurement equation. Our model is,</p>
<p><span class="math display">\[\begin{align}
y_t &amp;= \mu_t + \beta x_t + \epsilon_t \\
\mu_t = \mu_{t-1} + \eta_t.
\end{align}\]</span></p>
<p>We will use the package <code>bsts</code> to fit this model. The first thing to do when specifying a <code>bsts</code> package is the specify the contents of the latent state vector <span class="math inline">\(\mu_t\)</span></p>
<pre><code>## =-=-=-=-= Iteration 0 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 100 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 200 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 300 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 400 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 500 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 600 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 700 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 800 Tue Feb 20 18:52:00 2024 =-=-=-=-=
## =-=-=-=-= Iteration 900 Tue Feb 20 18:52:00 2024 =-=-=-=-=</code></pre>
<p><img src="series_files/figure-html/unnamed-chunk-60-1.png" width="672" /><img src="series_files/figure-html/unnamed-chunk-60-2.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prophet-lab.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dbreynol/DS809/edit/master/set4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
